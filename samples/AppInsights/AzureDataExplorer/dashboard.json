{"id":"d910d8eb-5185-4c6d-ada9-a1e02c0b4501","eTag":"1VC/CvEnrrvwTLx9R+sjzQ==","title":"Partner Insights","tiles":[{"id":"13ec686c-3e49-44e7-a8b3-c186544ae1f0","title":"Long Running SQL Queries (ms)","query":"traces\n| where timestamp  between(param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0005' \n| where customDimensions.alObjectId > 0 \n| extend eventId = customDimensions.eventId \n, sqlStatement = tostring(customDimensions.sqlStatement)\n, companyName = tostring(customDimensions.companyName)\n, extensionId = customDimensions.extensionId\n, extensionInfo = strcat(customDimensions.extensionName, ' ', customDimensions.extensionVersion, \n    (iff(isnotempty(tostring(customDimensions.extensionPublisher)), strcat(' - ', tostring(customDimensions.extensionPublisher)), '')))\n, alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, alStackTrace = tostring(customDimensions.alStackTrace)\n, clientType = tostring(customDimensions.clientType)\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000  \n| extend operationType = case(\n    sqlStatement startswith \"UPDATE\", \"UPDATE\"\n    , sqlStatement startswith \"DELETE\", \"DELETE\"\n    , sqlStatement startswith \"BeginTransaction\", \"BEGIN_TRANS\"\n    , sqlStatement matches regex \"INSERT INTO\", \"INSERT\"\n    , sqlStatement startswith \"SELECT\", \"SELECT\"\n    , sqlStatement matches regex \"IF EXISTS \\\\(SELECT (.*)\\\\) SELECT\", \"SELECT'\"\n    , sqlStatement has \"SELECT NEXT VALUE FOR\", \"SELECT_SEQUENCE_VALUE\"\n    , sqlStatement has \"SELECT @@SPID\", \"SELECT_SPID\"\n    , sqlStatement matches regex \"(.*)WITH\", \"SELECT\"\n    , sqlStatement startswith \"CREATE TABLE\", \"CREATE_TABLE\"\n    , sqlStatement startswith \"ALTER TABLE\", \"ALTER_TABLE\"\n    , sqlStatement startswith \"exec sp_rename\", \"RENAME_TABLE\" \n    , sqlStatement matches regex \"(.*)DROP TABLE\", \"DROP_TABLE\"\n    , sqlStatement startswith \"SET LOCK_TIMEOUT\", \"SET_LOCK_TIMEOUT\"\n    , sqlStatement has \"sp_getapplock\", \"GET_APP_LOCK\"\n    , \"UNKNOWN\"\n)\n, withUPDLOCK = iff(customDimensions.sqlStatement has 'UPDLOCK','Yes', 'No')\n, numberOfJoins = countof(sqlStatement, \"JOIN\") \n, numberOfFlowFields = countof(sqlStatement, \"OUTER APPLY\") \n, extensionIdsFromJOIN = tostring( extract_all(\"JOIN \\\"SQLDATABASE\\\"\\\\.dbo\\\\.\\\"CURRENTCOMPANY\\\\$.+?\\\\$(\\\\S+?)\\\"\", sqlStatement) )\n| parse kind=regex sqlStatement with selectPart:string \"FROM\" rest:string\n| extend numberOfColumnsSelected = case(\n    operationType == \"SELECT\", countof(selectPart,\",\") + 1\n    , operationType == \"SELECT'\", countof(selectPart,\",\") + 1\n    , 0\n)\n| sort by executionTimeInMS desc \n| project timestamp, \n    [\"Client Type\"] = clientType, \n    [\"Duration\"] = executionTimeInMS, \n    [\"Type\"] = operationType, \n    [\"FlowFields\"] = numberOfFlowFields, \n    [\"JOINs\"] = numberOfJoins, \n    [\"with UPDLOCK\"] = withUPDLOCK,\n    [\"Company Name\"] = companyName, \n    [\"AL Object Information\"] = alObjectInfo, \n    [\"AL Stack Trace\"] = alStackTrace,\n    [\"Extension Information\"] = extensionInfo\n    ","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"ad47d427-7a8e-48ec-992b-9a8acd32dea0","layout":{"x":0,"y":0,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"9ca5065c-fb79-43e1-8fa2-5ac4fb752fb0","column":{"type":"specified","value":"JOINs"},"conditions":[{"operator":">","value":"5"}],"color":"red","indicator":{"kind":"none"}},{"id":"809f035c-be67-4b38-aa6f-4024c928dcc1","column":{"type":"specified","value":"Duration"},"conditions":[{"value":"750","operator":">="},{"operator":"<","value":"5000"}],"color":"yellow","indicator":{"kind":"none"}},{"id":"59e733db-e278-4fdf-a2d9-2f8aaf72162f","column":{"type":"specified","value":"Duration"},"conditions":[{"operator":">=","value":"5000"}],"color":"red","indicator":{"kind":"none"}},{"id":"babcd001-83c5-4764-9101-0ad72fe15009","column":{"type":"specified","value":"JOINs"},"conditions":[{"operator":">","value":"2"},{"operator":"<=","value":"5"}],"color":"yellow","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"959ea782-a0db-450e-8a17-6186a8a72351","title":"Connections generating the Long SQL Queries (ms)","query":"traces\n| where timestamp  between(param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where operation_Name == 'Long Running Operation (SQL Query)'\n     or customDimensions.eventId == 'RT0005'\n| where customDimensions.alObjectId > 0 \n| extend companyName = tostring(customDimensions.companyName)\n, clientType = tostring(customDimensions.clientType)\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n| where isnotempty(companyName)\n| summarize [\"Total Duration\"] = sum(executionTimeInMS) by bin(timestamp, 1h), [\"Client Type\"] = clientType, companyName\n| where [\"Total Duration\"] > 0\n| sort by [\"Total Duration\"] desc\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"column","pageId":"ad47d427-7a8e-48ec-992b-9a8acd32dea0","layout":{"x":0,"y":8,"width":24,"height":7},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"specified","value":["Total Duration"]},"seriesColumns":{"type":"specified","value":["Client Type"]},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"a65a21b2-9b2b-45a3-8e72-b2d61fbbe4c4","title":"Top 20 Objects Used during the Long SQL Queries","query":"let _maxCount = 20;\ntraces\n| where timestamp  between(param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0005' \n| where customDimensions.alObjectId > 0 // filter out internal server calls\n| extend alObjectInfo = strcat(tostring(customDimensions.alObjectType), ' ', tostring(customDimensions.alObjectId), ' - ', \n     tostring(customDimensions.alObjectName))\n| summarize count() by alObjectInfo\n| sort by count_\n| limit _maxCount ","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"ad47d427-7a8e-48ec-992b-9a8acd32dea0","layout":{"x":0,"y":15,"width":24,"height":13},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"5347b506-e6a6-485b-964d-0cee1094f413","title":"Lock Timeouts","query":"traces\n| where timestamp between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0012'\n| extend\n   alObjectId = customDimensions.alObjectId\n  , companyName = tostring(customDimensions.companyName)\n  , clientType = tostring(customDimensions.clientType)\n  , alObjectType = customDimensions.alObjectType\n  , alObjectName = customDimensions.alObjectName\n  , extensionVersion = customDimensions.extensionVersion\n  , extensionInfo = strcat(customDimensions.extensionName, ' ', customDimensions.extensionVersion, \n    (iff(isnotempty(tostring(customDimensions.extensionPublisher)), strcat(' - ', tostring(customDimensions.extensionPublisher)), '')))\n  , extensionId = customDimensions.extensionId\n  , alStackTrace = tostring(customDimensions.alStackTrace)\n  , sqlStatement = customDimensions.sqlStatement\n  , sqlServerSessionId = customDimensions.sqlServerSessionId\n  , snapshotId = tostring(customDimensions.snapshotId)\n  , sessionId = customDimensions.sessionId\n| project timestamp, \n    [\"Session ID\"] = sessionId, \n    [\"Client Type\"] = clientType, \n    [\"Description\"] = message, \n    [\"Company Name\"] = companyName, \n    [\"AL Object Info\"] = strcat(alObjectType, ' ', alObjectId, ' - ', alObjectName), \n    [\"Extension Info\"] = extensionInfo, \n    [\"AL Stack Trace\"] =  alStackTrace, \n    [\"Snapshot ID\"] =  snapshotId","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"d6e13aaa-2ca2-406c-b433-74cb5a5e88b8","layout":{"x":0,"y":0,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"4220fb01-34f8-4e70-8143-e31509e4e02d","column":{"type":"specified","value":"Snapshot ID"},"conditions":[{"operator":">","value":""}],"color":"blue","indicator":{"kind":"text","text":{"type":"specified","value":"Filter"}}}],"colorRulesDisabled":false,"colorStyle":"light","crossFilterDisabled":false,"crossFilter":[{"interaction":"column","property":"Snapshot ID","parameterId":"74aed6f1-f0dc-4b9f-aed5-1806a369516b","disabled":false}]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"91213a4c-5db5-438a-89ff-ead4c3243b72","title":"Lock Timeouts Events per Snapshot ID","query":"let Timeouts = materialize (\n  traces\n  | where timestamp between (param_startTime .. param_endTime)\n  | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n  | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n  | where customDimensions.snapshotId == param_snapShotIdLockTimeout and isnotempty( param_snapShotIdLockTimeout)\n  | where customDimensions.eventId == 'RT0012'\n  | extend snapshotId = tostring( customDimensions.snapshotId )\n  | project snapshotId,\n      [\"Description\"] = message, \n      timestamp\n  ,   [\"AL Object - Lock Timeout\"] = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n  ,   [\"AL Stack Trace - Lock Timeout\"] = tostring(customDimensions.alStackTrace)\n  ,   [\"SQL Table - Lock Timeout\"] = tostring(customDimensions.sqlTableName)\n);\nTimeouts\n| join kind=leftouter(\n  traces\n  | where customDimensions.eventId == 'RT0013'\n  | where customDimensions.snapshotId == param_snapShotIdLockTimeout and isnotempty( param_snapShotIdLockTimeout)\n  | extend snapshotId = tostring( customDimensions.snapshotId )\n  | extend _alObjectHoldingLock = iff(toint(customDimensions.alObjectId) == 0, '', \n                strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName))\n  | extend _lockInfo = strcat(customDimensions.sqlLockRequestStatus, ' - ', customDimensions.sqlLockResourceType, ' (', customDimensions.sqlLockRequestMode, ')')\n| project snapshotId\n  ,   [\"Lock Information\"] = _lockInfo\n  ,   [\"AL Object - Holding Lock\"] = _alObjectHoldingLock\n  ,   [\"AL Stack Trace - Holding Lock\"] = tostring(customDimensions.alStackTrace)\n  ,   [\"SQL Table - Holding Lock\"] = tostring(customDimensions.sqlTableName)\n) on $left.snapshotId == $right.snapshotId\n| order by snapshotId\n| project-away snapshotId, snapshotId1","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"d6e13aaa-2ca2-406c-b433-74cb5a5e88b8","layout":{"x":0,"y":8,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":true,"crossFilter":[{"interaction":"column","property":"snapshotId","parameterId":"74aed6f1-f0dc-4b9f-aed5-1806a369516b","disabled":false}]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_snapShotIdLockTimeout","param_startTime"]},{"id":"10276c5c-c9cb-4701-92c7-55d6259b0722","title":"Object Information (30 Days)","query":"traces\n| where timestamp >= ago(30d)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.alObjectId == param_searchValue and isnotempty( param_searchValue)\n| extend _objectInfo = strcat (tostring(customDimensions.alObjectType), \" \", tostring(customDimensions.alObjectId))\n| extend _extensionInfo = strcat(customDimensions.extensionName, ' ', customDimensions.extensionVersion, \n    (iff(isnotempty(tostring(customDimensions.extensionPublisher)), strcat(' - ', tostring(customDimensions.extensionPublisher)), '')))\n| project [\"Object Information\"] = _objectInfo, \n    [\"Extension Information\"] = _extensionInfo\n| distinct [\"Object Information\"], [\"Extension Information\"]\n| sort by [\"Object Information\"] asc, [\"Extension Information\"] asc\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"b8d66075-467a-411c-89a8-156c06e1257b","layout":{"x":0,"y":0,"width":13,"height":6},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_environmentName","param_searchValue"]},{"id":"3fab52d9-1cfd-4fcb-aba5-ce3fc5a8460b","title":"Upgrade Step Duration by Tag","query":"let _upgradedStepStarted = materialize (\n    traces\n    | where timestamp between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.alCategory == \"ALUpgrade\"\n    | where customDimensions.eventId == \"AL0000EJ9\"\n    | project timestamp\n    , alUpgradeTag = tostring(customDimensions.alUpgradeTag)\n    , companyName = tostring(customDimensions.alCompanyName )\n    , step_started = timestamp\n    , session_Id\n    , aadTenantId = tostring(customDimensions.aadTenantId)\n    , environmentName = tostring(customDimensions.environmentName)\n);\nlet _upgradeStepFinished = materialize (\n    traces\n    | where timestamp between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.alCategory == \"ALUpgrade\"\n    | where customDimensions.eventId == \"AL0000EJA\"\n    | project alUpgradeTag = tostring(customDimensions.alUpgradeTag)\n    , customDimensions\n    , companyName = tostring(customDimensions.alCompanyName)\n    , step_finished = timestamp\n    , session_Id\n    , aadTenantId = tostring(customDimensions.aadTenantId)\n    , environmentName = tostring(customDimensions.environmentName)\n);\n_upgradedStepStarted\n| join kind=leftouter (\n    _upgradeStepFinished\n) on aadTenantId, session_Id, companyName, alUpgradeTag\n| extend duration = toreal(step_finished - step_started)/10000\n| extend duration = iff(duration > 0.0, duration, 0.0)\n| project timestamp, [\"Duration (ms)\"] = duration, [\"Company Name\"] = companyName, [\"AL Upgrade Tag\"] = alUpgradeTag\n| order by timestamp asc \n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"9fcb1376-774c-4321-947a-caa8299a66cb","layout":{"x":0,"y":0,"width":16,"height":15},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"b3f5500a-e2c8-4272-90bc-cc17006d6acd","title":"Top 20 SQL Queries that holds Database Locks","query":"let _searchSting = 'AL CallStack: ';\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0005'\n| where customDimensions.sqlStatement has 'UPDLOCK'\n| project timestamp\n, [\"Client Type\"] = customDimensions.clientType\n, [\"Company Name\"] = customDimensions.companyName\n, [\"Duration (ms)\"] = toreal(totimespan(customDimensions.executionTime))/10000 \n, [\"Object Information\"] = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' ', \n    customDimensions.alObjectName)\n, [\"Stack Trace\"] = substring(customDimensions.alStackTrace, \n                            indexof(customDimensions.alStackTrace, _searchSting) + strlen(_searchSting))\n, [\"Extension Information\"] = strcat(customDimensions.extensionName, ' ' , customDimensions.extensionVersion, ' - ',\n    customDimensions.extensionPublisher)\n| sort by ['Duration (ms)'] desc\n| limit 20","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"d6e13aaa-2ca2-406c-b433-74cb5a5e88b8","layout":{"x":0,"y":16,"width":24,"height":7},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[],"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_endTime","param_environmentName","param_startTime"]},{"id":"3057bee3-2b59-491c-9691-3e035bc1d6f1","title":"Top 20 Slowest AL Methods (in ms)","query":"let _maxCount = 20;\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| extend alMethod = tostring( customDimensions.alMethod )\n, alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n, extensionInfo = strcat( customDimensions.extensionName, ' ', customDimensions.extensionVersion)\n, alStackTrace = tostring(customDimensions.alStackTrace)\n| summarize count(), sum( executionTimeInMS ), avg( executionTimeInMS ) by alObjectInfo, alMethod, extensionInfo, alStackTrace\n| order by avg_executionTimeInMS desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"AL Method\"] = alMethod,\n    [\"AL Stack Trace\"] = alStackTrace,\n    [\"Extension Information\"] = extensionInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInMS, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInMS,2)\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":0,"y":0,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"5f6d2007-b704-4550-9904-b56eef168eee","column":{"type":"specified","value":"Avg Duration"},"conditions":[{"operator":">","value":"5000"}],"color":"red","indicator":{"kind":"none"}},{"id":"4c8ca430-ad4f-440c-9613-909a27121c70","column":{"type":"specified","value":"Avg Duration"},"conditions":[{"operator":">","value":"750"},{"operator":"<=","value":"5000"}],"color":"yellow","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"4e9305ff-62f4-4036-8745-793d814900f8","title":"Top 20 Page Usage","query":"let _maxCount = 20;\nlet _searchType = toupper('PAGE');\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| where toupper(customDimensions.alObjectType) == _searchType\n| extend alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTime = customDimensions.executionTime\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n| extend executionTimeInSec = executionTimeInMS / 1000\n| summarize count(), sum( executionTimeInSec ), avg( executionTimeInSec ) by alObjectInfo\n| order by avg_executionTimeInSec desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInSec, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInSec,2)\n| sort by Ocurrance desc\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":0,"y":8,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"c72ca054-fa22-480a-8b43-8f0ae6913bc5","title":"Top 20 Report Usage","query":"let _maxCount = 20;\nlet _searchType = toupper('REPORT');\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| where toupper(customDimensions.alObjectType) == _searchType\n| extend alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTime = customDimensions.executionTime\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n| extend executionTimeInSec = executionTimeInMS / 1000\n| summarize count(), sum( executionTimeInSec ), avg( executionTimeInSec ) by alObjectInfo\n| order by avg_executionTimeInSec desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInSec, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInSec,2)\n| sort by Ocurrance desc\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":12,"y":8,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"236c3e98-86f0-4182-be97-7fc55b2f27bd","title":"Top 20 Codeunit Usage","query":"let _maxCount = 20;\nlet _searchType = toupper('CODEUNIT');\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| where toupper(customDimensions.alObjectType) == _searchType\n| extend alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTime = customDimensions.executionTime\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n| extend executionTimeInSec = executionTimeInMS / 1000\n| summarize count(), sum( executionTimeInSec ), avg( executionTimeInSec ) by alObjectInfo\n| order by avg_executionTimeInSec desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInSec, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInSec,2)\n| sort by Ocurrance desc\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":0,"y":20,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"87c5ad3f-a813-4461-8964-5e5e4e7463bb","title":"Top 20 Query Usage","query":"let _maxCount = 20;\nlet _searchType = 'QUERY';\ntraces\n| where timestamp between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| where toupper(customDimensions.alObjectType) == _searchType\n| extend alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTime = customDimensions.executionTime\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n| extend executionTimeInSec = executionTimeInMS / 1000\n| summarize count(), sum( executionTimeInSec ), avg( executionTimeInSec ) by alObjectInfo\n| order by avg_executionTimeInSec desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInSec, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInSec,2)\n| sort by Ocurrance desc\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":0,"y":32,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"ffade918-e850-425a-9bcc-7cb287620823","title":"Top 20 XMLport Usage","query":"let _maxCount = 20;\nlet _searchType = 'XMLPORT';\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == 'RT0018'\n| where toupper(customDimensions.alObjectType) == _searchType\n| extend alObjectInfo = strcat(customDimensions.alObjectType, ' ', customDimensions.alObjectId, ' - ', customDimensions.alObjectName)\n, executionTime = customDimensions.executionTime\n, executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000 //the datatype for executionTime is timespan \n| extend executionTimeInSec = executionTimeInMS / 1000\n| summarize count(), sum( executionTimeInSec ), avg( executionTimeInSec ) by alObjectInfo\n| order by avg_executionTimeInSec desc \n| project [\"AL Object Information\"] = alObjectInfo,\n    [\"Ocurrance\"] = count_,\n    [\"Avg Duration\"] = round(avg_executionTimeInSec, 2),\n    [\"Total Duration\"] = round(sum_executionTimeInSec,2)\n| sort by Ocurrance desc\n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"bd35c241-31e4-446a-9ae5-4675b71682af","layout":{"x":12,"y":20,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":false,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"48c2e50d-260d-45f6-b097-5c6d235b3b9a","title":"Job Queue Status","query":"let _appInsightsTraces = materialize (\n    traces\n    | where timestamp  between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n);\nlet _enqueuedJQ = materialize (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E24\"\n    | summarize [\"Enqueued Count\"] = count() by bin(timestamp, 1h) \n);\nlet _startedJQ = materialize (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E25\"\n    | summarize [\"Started Count\"] = count() by bin(timestamp, 1h)\n);\nlet _finishedJQ = materialize (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E26\"\n    | summarize [\"Finished Count\"] = count() by bin(timestamp, 1h)\n);\n_startedJQ\n| join kind=leftouter ( _finishedJQ) on timestamp\n| join kind=leftouter (_enqueuedJQ) on timestamp\n| project-away timestamp1, timestamp2\n| sort by timestamp asc \n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"column","pageId":"140ed40e-8b20-4715-b809-6b231094c2a3","layout":{"x":0,"y":0,"width":23,"height":7},"visualOptions":{"hideTileTitle":false,"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[]},"hideLegend":false,"xColumnTitle":"","xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"a274638d-dc7d-4da2-9add-5f4fbc6860d4","title":"Job Queue Entries","query":"let _searchString = 'Job queue entry';\ntraces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId in (\"AL0000E24\", \"AL0000E25\", \"AL0000E26\")\n| extend _stateDescription = substring(message, strlen(_searchString), indexof(message, ':')-strlen(_searchString))\n| project  \n    [\"Entry Id\"] = tostring(customDimensions.alJobQueueId),\n    timestamp,\n    [\"State\"] = strcat(toupper(substring(_stateDescription, 1, 1)), substring(_stateDescription, 2)),\n    [\"Status\"] = customDimensions.alJobQueueStatus, \n    [\"Recurring\"] = customDimensions.alJobQueueIsRecurring,\n    [\"Result\"] = customDimensions.alJobQueueResult,\n    [\"Company\"] = customDimensions.alJobQueueCompanyName,\n    [\"Object Type\"] = customDimensions.alJobQueueObjectType,\n    [\"Object Id\"]  = customDimensions.alJobQueueObjectId\n| sort by [\"Entry Id\"] asc, timestamp asc","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"140ed40e-8b20-4715-b809-6b231094c2a3","layout":{"x":0,"y":7,"width":23,"height":12},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"a10e9ef8-5c0c-4efb-b1a3-ef0c1e342ece","column":{"type":"specified","value":"State"},"conditions":[{"operator":"==","value":"Started"}],"color":"yellow","indicator":{"kind":"none"}},{"id":"0ceaf96a-6cc0-4e4e-85e6-7886ade3fa0e","column":{"type":"specified","value":"State"},"conditions":[{"operator":"==","value":"Finished"}],"color":"green","indicator":{"kind":"none"}},{"id":"72668dc5-007c-4fa0-9071-2359860febd5","column":{"type":"specified","value":"Result"},"conditions":[{"operator":"==","value":"Fail"}],"color":"red","indicator":{"kind":"none"}},{"id":"18c62850-531a-4ac6-9d06-a6f16af976a3","column":{"type":"specified","value":"Result"},"conditions":[{"operator":"==","value":"Success"}],"color":"green","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"4e05830e-ff5a-43e2-8e64-23b64efb39a6","title":"Job Queue Overview","query":"let _appInsightsTraces = materialize  (\n    traces\n    | where timestamp between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.eventId in (\"AL0000E24\", \"AL0000E25\", \"AL0000E26\")\n);\nlet _startedEntries = toscalar (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E25\"\n    | count\n);\nlet _successEntries = toscalar (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E26\"\n    | where customDimensions.alJobQueueResult == 'Success'\n    | count\n);\nlet _failedEntries = toscalar (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E26\"\n    | where customDimensions.alJobQueueResult == 'Fail'\n    | count\n);\nlet _enqueuedEntries = toscalar (\n    _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E24\"\n    | count\n);\nlet _recurringEntries = toscalar (\n     _appInsightsTraces\n    | where customDimensions.eventId == \"AL0000E24\"\n    | where tostring(customDimensions.alJobQueueIsRecurring) == 'Yes'\n    | count \n);\n_appInsightsTraces\n| distinct tostring(customDimensions.alJobQueueId)\n| limit 1\n| project strcat(\"|\",\"Started\", \"|\", \"Successful\", \"|\", \"Failed\",\"|\", \"In Progress\",\"|\", \"Enqueued\",\"|\", \"Recurring\",\"|\\n\",\n                \"|------------------|:------------------------------------------------|\\n\",\n                \"|\", _startedEntries, \"|\", _successEntries, \"|\", _failedEntries, \"|\",\n                _startedEntries - _successEntries - _failedEntries, \"|\", _enqueuedEntries - _recurringEntries, \"|\",\n                _recurringEntries, \"|\")","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"markdown","pageId":"97e9f884-1517-4f29-b286-e60b13f4faa8","layout":{"x":0,"y":12,"width":18,"height":4},"visualOptions":{"xColumn":{"type":"infer"},"hideTileTitle":false},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"7938bf0d-cbec-4628-9555-d04cb8effd67","title":"Web Service Calls Overview for past 24 hrs.","query":"let _limit = 4;\nlet _appInsightsTraces = materialize  (\n    traces\n    | where timestamp  between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.eventId == \"RT0008\"\n    | project timestamp, message, customDimensions\n);\nlet _soapThreshold = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"SOAP\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | summarize round(avg(_processingTimeMS),2)\n);\nlet _soapCalls = toscalar( \n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"SOAP\"\n    | count\n);\nlet _longRunningSoapCalls = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"SOAP\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | where _processingTimeMS > (_soapThreshold * _limit)\n    | count\n);\nlet _odataThreshold = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) contains \"ODATA\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | summarize round(avg(_processingTimeMS),2)\n);\nlet _odataCalls = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) contains \"ODATA\"\n    | count\n);\nlet _longRunningOdataCalls = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"ODATA\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | where _processingTimeMS > (_odataThreshold * _limit)\n    | count\n);\nlet _apiThreshold = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"API\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | summarize round(avg(_processingTimeMS),2)\n);\nlet _apiCalls = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"API\"\n    | count\n);\nlet _longRunningApiCalls = toscalar(\n    _appInsightsTraces\n    | where toupper(customDimensions.category) == \"API\"\n    | extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n    | where _processingTimeMS > (_apiThreshold * _limit)\n    | count\n);\n_appInsightsTraces\n| limit 1\n| project strcat(\"|\",\"SOAP Calls\", \"|\", \"Average\", \"|\", \"Long Running\", \"|\", \" \", \"|\", \n                    \"OData Calls\", \"|\", \"Average\", \"|\", \"Long Running\", \"|\", \" \", \"|\",\n                    \"API Calls\", \"|\", \"Average\", \"|\", \"Long Running|\\n\",\n                \"|------------------|:---------------|\\n\",\n                \"|\", _soapCalls, \"|\", _soapThreshold, \"|\", _longRunningSoapCalls, \"|\", \"\", \n                \"|\", _odataCalls, \"|\", _odataThreshold, \"|\", _longRunningOdataCalls, \"|\", \"\",\n                \"|\", _apiCalls, \"|\", _apiThreshold, \"|\", _longRunningApiCalls, \"|\\n\",\n                \"**Long Running calls are those that are greater than 4x the Average**\")","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"markdown","pageId":"97e9f884-1517-4f29-b286-e60b13f4faa8","layout":{"x":0,"y":8,"width":18,"height":4},"visualOptions":{"xColumn":{"type":"infer"},"hideTileTitle":false},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"ebf8b1f4-7c24-4930-ba00-a221a63f9974","title":"SOAP Usage (in ms) [Limited to past 24 hrs.]","query":"let _maxDuration = 24h;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where timestamp between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"SOAP\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| project [\"Endpoint\"] = _endpoint, \n        [\"Object Type\"] = tostring(customDimensions.alObjectType), \n        [\"Object No.\"] = tostring(customDimensions.alObjectId), \n        _processingTimeMS, \n        [\"Publisher\"] = tostring(customDimensions.extensionPublisher)\n| summarize count(), [\"Avg. Time\"] = round(avg(_processingTimeMS),2), [\"Total Time\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"], [\"Object Type\"], [\"Object No.\"], [\"Publisher\"]\n| sort by count_\n\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"16ab4bc5-dc65-4f07-98a5-35d543b5b95e","layout":{"x":0,"y":0,"width":24,"height":9},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"e68a5ddf-f805-448f-809a-83b788c5912d","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"5000"}],"color":"red","indicator":{"kind":"none"}},{"id":"e3ca07dc-d5fd-4d50-b11d-ee771b58f494","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"750"},{"operator":"<=","value":"5000"}],"color":"yellow","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"1a64f20a-a413-4f46-be33-0424bca6812a","title":"Top 20 SOAP Calls by Volume","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"SOAP\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"SOAP Calls\"] = count() by [\"Endpoint\"] = _endpoint\n| sort by [\"SOAP Calls\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"16ab4bc5-dc65-4f07-98a5-35d543b5b95e","layout":{"x":12,"y":9,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"cd1d8cd9-e358-4776-8290-fadaa644604f","title":"Top 20 SOAP Calls by Duration (in ms)","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"SOAP\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"SOAP Duration\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"] = _endpoint\n| sort by [\"SOAP Duration\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"16ab4bc5-dc65-4f07-98a5-35d543b5b95e","layout":{"x":0,"y":9,"width":12,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"6ac841b7-c8bf-4013-a7c9-027fc30bb932","title":"OData Usage (in ms) [Limited to past 24 hrs.]","query":"let _maxDuration = 24h;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) contains \"ODATA\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| project [\"Endpoint\"] = _endpoint, \n        [\"Object Type\"] = tostring(customDimensions.alObjectType), \n        [\"Object No.\"] = tostring(customDimensions.alObjectId), \n        _processingTimeMS, \n        [\"Publisher\"] = tostring(customDimensions.extensionPublisher)\n| summarize count(), [\"Avg. Time\"] = round(avg(_processingTimeMS),2), [\"Total Time\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"], [\"Object Type\"], [\"Object No.\"], [\"Publisher\"]\n| sort by count_\n\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"00cb9181-78af-4c89-a68a-a4b267014cc9","layout":{"x":0,"y":0,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"155d8626-2f4f-49c9-9df5-72d44c063dfd","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"5000"}],"color":"red","indicator":{"kind":"none"}},{"id":"c987037f-ff44-4c5a-94f1-4df069438318","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"750"},{"operator":"<=","value":"5000"}],"color":"yellow","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"f297d880-e51b-42c7-8f8a-8438f04f5367","title":"Top 20 OData Calls by Volume","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) contains \"ODATA\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"SOAP Calls\"] = count() by [\"Endpoint\"] = _endpoint\n| sort by [\"SOAP Calls\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"00cb9181-78af-4c89-a68a-a4b267014cc9","layout":{"x":13,"y":8,"width":11,"height":13},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"f3d99b37-19ce-4467-b9f0-df26f53c9ebf","title":"Top 20 OData Calls by Duration (in ms)","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) contains \"ODATA\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"OData Duration\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"] = _endpoint\n| sort by [\"OData Duration\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"00cb9181-78af-4c89-a68a-a4b267014cc9","layout":{"x":0,"y":8,"width":13,"height":13},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"12f5c867-95a1-41dd-81cd-65e62f3acb69","title":"API Usage (in ms) [Limited to past 24 hrs.]","query":"let _maxDuration = 24h;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"API\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| project [\"Endpoint\"] = _endpoint, \n        [\"Object Type\"] = tostring(customDimensions.alObjectType), \n        [\"Object No.\"] = tostring(customDimensions.alObjectId), \n        _processingTimeMS, \n        [\"Publisher\"] = tostring(customDimensions.extensionPublisher)\n| summarize count(), [\"Avg. Time\"] = round(avg(_processingTimeMS),2), [\"Total Time\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"], [\"Object Type\"], [\"Object No.\"], [\"Publisher\"]\n| sort by count_\n\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"table","pageId":"e27535ee-50c4-434a-bdc3-9daac844e650","layout":{"x":0,"y":0,"width":24,"height":8},"visualOptions":{"hideTileTitle":false,"table__enableRenderLinks":true,"table__renderLinksForColumns":[],"colorRules":[{"id":"838a3f3a-8ca8-4bd2-89aa-290a7b035678","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"5000"}],"color":"red","indicator":{"kind":"none"}},{"id":"700b02ff-02e4-4e38-9c21-2286e176a81d","column":{"type":"specified","value":"Avg. Time"},"conditions":[{"operator":">","value":"750"},{"operator":"<=","value":"5000"}],"color":"yellow","indicator":{"kind":"none"}}],"colorRulesDisabled":false,"colorStyle":"bold","crossFilterDisabled":false,"crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"08dff683-4da2-448a-af09-174583f82bf9","title":"Top 20 API Calls by Volume","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"API\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"SOAP Calls\"] = count() by [\"Endpoint\"] = _endpoint\n| sort by [\"SOAP Calls\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"e27535ee-50c4-434a-bdc3-9daac844e650","layout":{"x":13,"y":8,"width":11,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"c19f2649-6823-4931-a6c6-ad9812ee875c","title":"Top 20 API Calls by Duration (in ms)","query":"let _maxDuration = 24h;\nlet _maxCount = 20;\nlet _currentDuration = param_endTime - param_startTime;\nlet _duration = iff(_currentDuration > _maxDuration , _maxDuration, _currentDuration);\ntraces \n| where timestamp >= ago(_duration)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n| where customDimensions.eventId == \"RT0008\"\n| where toupper(customDimensions.category) == \"API\"\n| extend _endpoint = strcat(\"WS/\", customDimensions.alObjectType,'/', customDimensions.alObjectId, '(',tostring(customDimensions.endpoint),')')\n| extend _processingTimeMS = toreal(totimespan(customDimensions.serverExecutionTime))/10000\n| summarize [\"API Duration\"] = round(sum(_processingTimeMS),2) by [\"Endpoint\"] = _endpoint\n| sort by [\"API Duration\"] desc \n| limit _maxCount\n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"pie","pageId":"e27535ee-50c4-434a-bdc3-9daac844e650","layout":{"x":0,"y":8,"width":13,"height":12},"visualOptions":{"hideTileTitle":false,"hideLegend":false,"xColumn":{"type":"infer"},"yColumns":{"type":"infer"},"seriesColumns":{"type":"infer"},"crossFilterDisabled":false,"labelDisabled":true,"pie__label":["name","percentage"],"tooltipDisabled":false,"pie__tooltip":["name","percentage","value"],"pie__orderBy":"size","pie__kind":"pie","crossFilter":[]},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"64a247e2-cc83-4da0-9cd6-ef099b93f0de","title":"Long Running SQL Queries for the defined Time Range","query":"let _upperLimit = 5000;\nlet _appInsightsTraces = materialize  (\n    traces \n    | where timestamp  between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.eventId == \"RT0005\"\n    | where customDimensions.alObjectId > 0\n);\nlet _lowerThresholdinMs = toscalar (\n    _appInsightsTraces\n    | limit 1\n    | extend _executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n    | extend _longRunningThresholdInMS = iff(toreal(customDimensions.longRunningThresholdInMs) > 0, \n            toreal(customDimensions.longRunningThresholdInMs),\n            toreal(totimespan(customDimensions.longRunningThreshold))/10000)\n    | project tostring(toint(_longRunningThresholdInMS))\n);\nlet _totalQueries = toscalar (\n    _appInsightsTraces\n    | count \n);\nlet _tooManyJoins = toscalar (\n    _appInsightsTraces\n    | extend sqlStatement = tostring(customDimensions.sqlStatement)\n    | extend _numberOfJoins = countof(sqlStatement, \"JOIN\")\n    | where _numberOfJoins > 5\n    | count \n);\nlet _longQueries = toscalar (\n    _appInsightsTraces\n    | extend _executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n    | where _executionTimeInMS > toint(customDimensions.longRunningThresholdInMs) and _executionTimeInMS < _upperLimit\n    | count \n);\nlet _veryLongQueries = toscalar (\n    _appInsightsTraces\n    | extend _executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n    | where _executionTimeInMS >= _upperLimit\n    | count \n);\n_appInsightsTraces\n| limit 1\n| project strcat(\"|\",\"Total Queries\", \n                \"|\", \"Long Running Queries\", \n                \"|\", \"Very Long Running Queries\", \n                \"|\", \"Queries with  many Joins\", \"|\\n\", \n                \"|------------------|:---------------|\\n\",\n                \"|\", _totalQueries, \"|\", _longQueries, \"|\", _veryLongQueries, \"|\", _tooManyJoins, \"|\\n\",\n                strcat(\"**Lower Threshold: greater than \", _lowerThresholdinMs, \" ms and less than \", _upperLimit, \" ms\\n\",\n                        \"Upper Threshold: greater than or equal to \", _upperLimit, \" ms**\"))","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"markdown","pageId":"97e9f884-1517-4f29-b286-e60b13f4faa8","layout":{"x":0,"y":0,"width":18,"height":4},"visualOptions":{"xColumn":{"type":"infer"},"hideTileTitle":false},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]},{"id":"a34dbc3e-f5a4-468a-bd13-27c8fff73640","title":"Long Running AL Methods by Object Type for the defined Time Range","query":"let _appInsightsTraces = materialize  (\n    traces\n    | where timestamp between (param_startTime .. param_endTime)\n    | where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n    | where customDimensions.environmentName == param_environmentName and isnotempty( param_environmentName)\n    | where customDimensions.eventId == \"RT0018\"\n    | extend _executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n    | extend _longRunningThresholdInMS = iff(toreal(customDimensions.longRunningThresholdInMs) > 0, \n            toreal(customDimensions.longRunningThresholdInMs),\n            toreal(totimespan(customDimensions.longRunningThreshold))/10000)\n    | where _executionTimeInMS > _longRunningThresholdInMS\n    | project timestamp, message, [\"alObjectType\"] = toupper(customDimensions.alObjectType), customDimensions\n            \n);\nlet _thresholdInMs = toscalar (\n    _appInsightsTraces\n    | limit 1\n    | extend _executionTimeInMS = toreal(totimespan(customDimensions.executionTime))/10000\n    | extend _longRunningThresholdInMS = iff(toreal(customDimensions.longRunningThresholdInMs) > 0, \n            toreal(customDimensions.longRunningThresholdInMs),\n            toreal(totimespan(customDimensions.longRunningThreshold))/10000)\n    | project tostring(toint(_longRunningThresholdInMS))\n);\nlet _longPages = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"PAGE\" \n    | count \n);\nlet _longCodeunits = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"CODEUNIT\" \n    | count \n);\nlet _longReports = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"REPORT\" \n    | count \n);\nlet _longQueries = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"QUERY\" \n    | count \n);\nlet _longXMLPorts = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"XMLPORT\" \n    | count \n);\nlet _longTables = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"TABLE\" \n    | count \n);\nlet _longPageExtensions = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"PAGEEXTENSION\" \n    | count \n);\nlet _longTableExtensions = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"TABLEEXTENSION\" \n    | count \n);\nlet _longReportExtensions = toscalar (\n    _appInsightsTraces\n    | where alObjectType == \"REPORTEXTENSION\" \n    | count \n);\n_appInsightsTraces\n| limit 1\n| project strcat(\"|\", \"Table\",\n                \"|\",\"Page\", \n                \"|\", \"Codeunit\", \n                \"|\", \"Report\", \n                \"|\", \"XMLport\", \n                \"|\", \"Query\", \n                \"|\",\n                \"|\", \"Table Extension\", \n                \"|\", \"Page Extension\",\n                \"|\", \"Report Extension\", \"|\\n\", \n                \"|------------------|:---------------|\\n\",\n                \"|\", _longTables, \n                \"|\", _longPages,\n                \"|\", _longCodeunits, \n                \"|\", _longReports,  \n                \"|\", _longXMLPorts,\n                \"|\", _longQueries, \n                \"|\",\n                \"|\", _longTableExtensions,\n                \"|\", _longPageExtensions,\n                \"|\", _longReportExtensions,\"|\\n\",\n                strcat(\"**Threshold: \", _thresholdInMs, \" ms**\"))","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","visualType":"markdown","pageId":"97e9f884-1517-4f29-b286-e60b13f4faa8","layout":{"x":0,"y":4,"width":18,"height":4},"visualOptions":{"xColumn":{"type":"infer"},"hideTileTitle":false},"usedParamVariables":["param_aadTenantId","param_endTime","param_environmentName","param_startTime"]}],"dataSources":[{"id":"68d7cd20-612d-40de-85cb-f4b088877bc5","name":"BCAppInsights","clusterUri":"https://ade.applicationinsights.io/subscriptions/b5915005-6200-4e85-84de-db3c3ec559ef/resourcegroups/BC_Resource_Group","database":"BC_AppInsights_Resource","kind":"manual-kusto","scopeId":"kusto"}],"$schema":"https://dataexplorer.azure.com/static/d/schema/21/dashboard.json","autoRefresh":{"enabled":false},"parameters":[{"kind":"string","id":"da14361b-1ce2-471e-a305-bcb954b2df04","displayName":"AAD Tenant ID","variableName":"param_aadTenantId","selectionType":"single-all","defaultValue":{"kind":"all"},"dataSource":{"kind":"query","consumedVariables":["param_endTime","param_startTime"],"query":"traces\n| where timestamp  between (param_startTime .. param_endTime)\n| extend _aadTenantId = tostring(customDimensions.aadTenantId)\n| distinct _aadTenantId\n| project [\"AAD Tenant Id\"] = _aadTenantId","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","columns":{"value":"AAD Tenant Id"}},"showOnPages":{"kind":"all"}},{"kind":"string","id":"1ad4eeaa-4bea-4b91-a7cd-704fe31fd185","displayName":"Environment Name","variableName":"param_environmentName","selectionType":"single-all","defaultValue":{"kind":"all"},"dataSource":{"kind":"query","consumedVariables":["param_aadTenantId","param_endTime","param_startTime"],"query":"traces\n| where timestamp  between (param_startTime .. param_endTime)\n| where customDimensions.aadTenantId == param_aadTenantId and isnotempty( param_aadTenantId)\n| sort by timestamp desc\n| summarize arg_max(timestamp,*) by tostring(customDimensions.environmentType), \n                                    tostring(customDimensions.environmentName)\n| where isnotempty( customDimensions.environmentName)\n| project [\"Environment Name\"] = tostring(customDimensions.environmentName)\n| sort by ['Environment Name'] asc \n","dataSourceId":"68d7cd20-612d-40de-85cb-f4b088877bc5","columns":{"value":"Environment Name"}},"showOnPages":{"kind":"all"}},{"kind":"duration","id":"8d390c86-b4cb-4260-b248-436ffde7a9ea","displayName":"Time range","beginVariableName":"param_startTime","endVariableName":"param_endTime","defaultValue":{"kind":"dynamic","count":2,"unit":"days"},"showOnPages":{"kind":"selection","pageIds":["ad47d427-7a8e-48ec-992b-9a8acd32dea0","bd35c241-31e4-446a-9ae5-4675b71682af","140ed40e-8b20-4715-b809-6b231094c2a3","16ab4bc5-dc65-4f07-98a5-35d543b5b95e","d6e13aaa-2ca2-406c-b433-74cb5a5e88b8","5a791d6d-8f0d-493f-a88a-5deacd777a16","97e9f884-1517-4f29-b286-e60b13f4faa8"]}},{"kind":"string","selectionType":"freetext","id":"74aed6f1-f0dc-4b9f-aed5-1806a369516b","displayName":"Lock Timeout Snapshot ID","variableName":"param_snapShotIdLockTimeout","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["d6e13aaa-2ca2-406c-b433-74cb5a5e88b8"]}},{"kind":"string","selectionType":"freetext","id":"31332931-2b31-4fbf-9c3f-94b1409eb0e2","displayName":"Wait Stat Snapshot ID","variableName":"param_snapShotIdWaitStat","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["5a791d6d-8f0d-493f-a88a-5deacd777a16"]}},{"kind":"string","selectionType":"freetext","id":"ede75783-4475-486a-a18e-29df1e8afb2c","displayName":"Search Value","variableName":"param_searchValue","defaultValue":{"kind":"all"},"showOnPages":{"kind":"selection","pageIds":["b8d66075-467a-411c-89a8-156c06e1257b"]}}],"pages":[{"name":"Overview","id":"97e9f884-1517-4f29-b286-e60b13f4faa8"},{"name":"SQL Query Usage","id":"ad47d427-7a8e-48ec-992b-9a8acd32dea0"},{"name":"AL Method Usage","id":"bd35c241-31e4-446a-9ae5-4675b71682af"},{"name":"SOAP Usage","id":"16ab4bc5-dc65-4f07-98a5-35d543b5b95e"},{"name":"OData Usage","id":"00cb9181-78af-4c89-a68a-a4b267014cc9"},{"name":"API Usage","id":"e27535ee-50c4-434a-bdc3-9daac844e650"},{"name":"Job Queue ","id":"140ed40e-8b20-4715-b809-6b231094c2a3"},{"name":"Upgrades","id":"9fcb1376-774c-4321-947a-caa8299a66cb"},{"name":"Database Locks","id":"d6e13aaa-2ca2-406c-b433-74cb5a5e88b8"},{"name":"Lookup","id":"b8d66075-467a-411c-89a8-156c06e1257b"}],"schema_version":"21"}